<%= render "shared/header" %>

<div class="user-main">
  <div class="history-container">
    <h2 class="history-title"><%= current_user.name%>さんの都道府県訪問記録</h2>
    <%= form_with model: @user, url: user_path(@user), method: :patch, local: true do |f| %>

    <%# 以下からhigh-chartsの記述 %>
    <div class="donut-chart">
    <%= pie_chart @user_histories, options = {
        donut: true,  # ドーナツグラフにするための記述
        colors: ["#1760a0", "rgb(238, 247, 255)"],  # 色を指定
        label: "都道府県数",  # ホバーした時に表示される詳細の項目名を指定
        legend: false, # 凡例非表示
        library: {
          title: {
            text: "#{@history_true}/47",  # 中央(ドーナツの穴)部分の記述を指定
            align: 'center',  # 位置を指定（水平方向）
            verticalAlign: 'middle',  # 位置を指定（垂直方向）
            style: {
              color: '#1760a0',
              fontWeight: 'bold',
              fontSize: '28px'
            },  
          },
          plotOptions: {
            series: {
              animation: {
                duration: 1400
              }
            },
            pie: {
              dataLabels: {
                enabled: false,  #データラベルを表示するか否か
              },
              size: "110%",
              innerSize: '50%',  # 中央(ドーナツの穴)部分のサイズを指定
            }
          },
        }
      } %>
    </div>

    <div class="prefecture-check-box">
      <%= f.collection_check_boxes :history_ids, History.all, :id, :name do |history| %>
      <span class="history-details"><%=  history.label {history.check_box + history.text} %></span>
      <% end %>
    </div>
    <div class="save-btn">
      <%= f.submit "UPDATE", class: "update" %>
    </div>
  <% end %>
  </div>
</div>

<%= render "shared/footer" %>